<%= form_with(model: welcome, local: true) do |form| %>
  <% if welcome.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(welcome.errors.count, "error") %> prohibited this welcome from being saved:</h2>

      <ul>
      <% welcome.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  <% if current_user.try(:admin?) and @group.membership_ids.length > 1 %>
  <h1> Evaluations sent! </h1>
  <% for i in 0...@group.membership_ids.length %>
    <% @users = User.all.collect %>
      <% @members = [] %>
      <% @users.each do |user| %>
        <% if user.membership_ids.include? @group.membership_ids[i] %>
          <% @members.push user %> 
        <% end %>
      <% end %>
 
      <% @members.each_with_index do |member, i| %>
        <% @members.each_with_index do |member, n|  %>
          <% @rating = Rating.new(:group_id => @group.id, :user_id => @members[i].id, :ratee_id => @members[n].id) %> 
          <% @rating.save %>
        <% end %>
      <% end %>
    <% end %>
    <br><%= link_to 'Back to Groups', groups_path, :class => "btn btn-default" %>
  <br><%= link_to 'Back to Classes', courses_path, :class => "btn btn-default" %>
<% end %>
<% end %>
